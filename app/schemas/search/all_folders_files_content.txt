### Combined Content from Folder: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search ###



# ===== Folder: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search =====

# --- File: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search\search_analytics.py ---
"""
Search analytics & popular queries schemas
"""
from datetime import date, datetime
from typing import List, Dict
from pydantic import Field

from app.schemas.common.base import BaseSchema
from app.schemas.common.filters import DateRangeFilter


class SearchTermStats(BaseSchema):
    """Statistics for a single search term"""
    term: str
    search_count: int
    avg_results: float
    zero_result_count: int
    last_searched_at: datetime


class SearchAnalytics(BaseSchema):
    """Search analytics summary"""
    period: DateRangeFilter

    total_searches: int
    unique_terms: int
    zero_result_searches: int

    top_terms: List[SearchTermStats] = Field(default_factory=list)
    zero_result_terms: List[SearchTermStats] = Field(default_factory=list)

    # Aggregated metrics
    avg_results_per_search: float

# --- File: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search\search_autocomplete.py ---
"""
Autocomplete / suggestion schemas
"""
from typing import List
from pydantic import Field

from app.schemas.common.base import BaseSchema, BaseCreateSchema


class AutocompleteRequest(BaseCreateSchema):
    """Request for autocomplete suggestions"""
    prefix: str = Field(..., min_length=1, max_length=100)
    type: str = Field(
        "hostel",
        pattern="^(hostel|city|area)$",
        description="What to autocomplete",
    )
    limit: int = Field(10, ge=1, le=20)


class Suggestion(BaseSchema):
    """Single suggestion"""
    value: str
    label: str
    type: str
    extra: dict = Field(default_factory=dict)


class AutocompleteResponse(BaseSchema):
    """Autocomplete result set"""
    suggestions: List[Suggestion]

# --- File: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search\search_filters.py ---
"""
Reusable search filter schemas (common for advanced search)
"""
from typing import List, Optional
from pydantic import Field
from decimal import Decimal

from app.schemas.common.base import BaseFilterSchema


class PriceFilter(BaseFilterSchema):
    min_price: Optional[Decimal] = Field(None, ge=0)
    max_price: Optional[Decimal] = Field(None, ge=0)


class RatingFilter(BaseFilterSchema):
    min_rating: Optional[Decimal] = Field(None, ge=0, le=5)
    max_rating: Optional[Decimal] = Field(None, ge=0, le=5)


class AmenityFilter(BaseFilterSchema):
    amenities: Optional[List[str]] = Field(None)

# --- File: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search\search_request.py ---
"""
Search request schemas (hostels, rooms, etc.)
"""
from typing import List, Optional
from pydantic import Field
from uuid import UUID
from decimal import Decimal

from app.schemas.common.base import BaseSchema, BaseFilterSchema
from app.schemas.common.enums import HostelType, RoomType


class BasicSearchRequest(BaseFilterSchema):
    """Simple keyword search"""
    query: str = Field(..., min_length=1, max_length=255)


class AdvancedSearchRequest(BaseFilterSchema):
    """Advanced hostel search request (public)"""
    query: Optional[str] = Field(None, max_length=255)

    # Location
    city: Optional[str] = None
    state: Optional[str] = None
    pincode: Optional[str] = Field(None, pattern=r"^\d{6}$")

    latitude: Optional[Decimal] = Field(None, ge=-90, le=90)
    longitude: Optional[Decimal] = Field(None, ge=-180, le=180)
    radius_km: Optional[Decimal] = Field(None, ge=0, le=100)

    # Filters
    hostel_type: Optional[HostelType] = None
    room_type: Optional[RoomType] = None

    min_price: Optional[Decimal] = Field(None, ge=0)
    max_price: Optional[Decimal] = Field(None, ge=0)

    amenities: Optional[List[str]] = None
    min_rating: Optional[Decimal] = Field(None, ge=0, le=5)

    verified_only: bool = Field(False)
    available_only: bool = Field(False)

    # Sorting
    sort_by: str = Field(
        "relevance",
        pattern="^(relevance|price_asc|price_desc|rating_desc|distance_asc|newest)$",
    )
    page: int = Field(1, ge=1)
    page_size: int = Field(20, ge=1, le=100)

# --- File: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search\search_response.py ---
"""
Search response schemas
"""
from typing import List, Dict, Any
from pydantic import Field
from decimal import Decimal
from uuid import UUID

from app.schemas.common.base import BaseSchema
from app.schemas.hostel.hostel_public import PublicHostelCard


class SearchResultItem(BaseSchema):
    """Generic search result wrapper (for hostels now, extensible later)"""
    hostel: PublicHostelCard
    score: Decimal = Field(..., description="Relevance score from search engine")


class FacetBucket(BaseSchema):
    """Facet value & count"""
    value: str
    count: int
    label: str


class FacetedSearchResponse(BaseSchema):
    """Response for advanced faceted search"""
    results: List[SearchResultItem]
    total_results: int
    page: int
    page_size: int
    total_pages: int

    # Facets
    facets: Dict[str, List[FacetBucket]] = Field(
        default_factory=dict, description="FacetName -> bucket list"
    )

    # Debug / meta
    query_time_ms: int = Field(..., description="Search execution time (ms)")
    raw_query: Dict[str, Any] = Field(
        default_factory=dict,
        description="Raw search engine query (optional, for debugging)",
    )

# --- File: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search\search_sort.py ---
"""
Search sort option schemas
"""
from pydantic import Field

from app.schemas.common.base import BaseSchema


class SortCriteria(BaseSchema):
    """Sort criteria used by search"""
    sort_by: str = Field(
        ...,
        pattern="^(relevance|price|rating|distance|created_at)$",
        description="Field to sort by",
    )
    sort_order: str = Field(
        "asc",
        pattern="^(asc|desc)$",
        description="Sort direction",
    )

# --- File: C:\Users\HP\OneDrive\Documents\GitHub\hostel-back\app\schemas\search\__init__.py ---

